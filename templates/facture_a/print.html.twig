{# templates/pdf/products.html.twig #}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Ticket_{{ vente.id }}</title>
    <style>
        /* Configuration spécifique pour imprimante thermique 80mm */
        @page {
            size: 80mm 210mm;
            margin: 2mm;
        }

        body { 
            font-family: "Courier New", Courier, monospace; /* Police mono pour l'aspect ticket */
            font-size: 8pt; 
            width: 76mm; /* Largeur utile réelle */
            margin: 0;
            color: #000;
        }

        .center { text-align: center; }
        .bold { font-weight: bold; }
        
        .header {
            margin-bottom: 10px;
            border-bottom: 1px dashed #000;
            padding-bottom: 5px;
        }

        .header h1 { 
            font-size: 10pt; 
            margin: 5px 0; 
            text-transform: uppercase;
        }

        .info-client {
            margin-bottom: 10px;
            font-size: 7pt;
        }

        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 5px;
        }

        th { 
            border-bottom: 1px solid #000;
            text-align: left;
            font-size: 7pt;
            padding: 2px 0;
        }

        td { 
            padding: 3px 0; 
            vertical-align: top;
            font-size: 7pt;
        }

        /* Réglage des colonnes pour 80mm */
        .col-produit { width: 35%; }
        .col-qty { width: 10%; text-align: center; }
        .col-pu { width: 20%; text-align: right; }
        .col-total { width: 20%; text-align: right; }
        .col-paie { width: 15%; text-align: center; }

        .total-section {
            margin-top: 10px;
            border-top: 1px double #000;
            padding-top: 5px;
        }

        .row-total {
            display: flex;
            justify-content: space-between;
            font-size: 9pt;
        }

        .footer { 
            margin-top: 15px;
            text-align: center;
            font-size: 7pt;
            border-top: 1px dashed #000;
            padding-top: 5px;
        }
    </style>
</head>
<body>
    <div class="header center">
        <h1 class="bold">
        <strong>{{agences.activite}}</strong> <strong>{{agences.nom}}</strong> <br>
            <strong>{{ agences.adress }}</strong><br>
            <strong> Telephone : {{ agences.telephone }}</strong><br>
        </h1>
        <small>
            <strong>{{ agences.contribuable }}</strong><br>
            <strong>{{ agences.rccm }}</strong><br>
        </small>
    </div>
    <div class=" header center text-center">
        <img src="{{ qrCode }}" alt="QR Code">
    </div>
    <div class="info-client">
        <strong>Vente N°:</strong> {{ vente.id }}<br>
        <strong>Date:</strong> {{ "now"|date("d/m/Y H:i") }}<br>
        <strong>Client: {{ client.nom|upper }}<br></strong>
        <strong>Tel: {{ client.user.telephone }}</strong>
    </div>

    <table>
        <thead>
            <tr>
                <th class="col-produit">Item</th>
                <th class="col-qty">Qt</th>
                <th class="col-pu">P.U</th>
                <th class="col-total">Mt</th>
                <th class="col-paie">P</th>
            </tr>
        </thead>
        <tbody>
            {% set totalGeneral = 0 %}
            {% for facture in factures %}
            <tr>
                <td class="col-produit"><strong>{{ facture.produit.nom }}</strong></td>
                <td class="col-qty"><strong>{{ facture.quantite }}</strong></td>
                <td class="col-pu"><strong>{{ facture.prix|number_format(0, '', '') }}</strong></td>
                <td class="col-total"><strong>{{ facture.montant|number_format(0, '', '') }}</strong></td>
                <td class="col-paie"><strong>{{ facture.type|slice(0, 1) }}</strong></td> {# On ne garde que l'initiale pour gagner de la place #}
            </tr>
            {% set totalGeneral = totalGeneral + facture.montant %}
            {% else %}
            <tr>
                <td colspan="5" class="center">Aucun produit</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="total-section">
        <div style="text-align: right; font-size: 10pt;">
            <strong>TOTAL : {{ totalGeneral|number_format(0, '.', ' ') }} FCFA</strong>
        </div>
    </div>

    <div class="footer">
        Merci de votre confiance !<br>
        *** À bientôt ***
    </div>
</body>
</html>